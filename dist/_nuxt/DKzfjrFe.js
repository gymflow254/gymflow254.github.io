import{d as $,c as h,f as a,X as j,Q as J,o as K,B as W,y as Z,Y as ee,a0 as te,a1 as ae,C as oe}from"./DklLZOGC.js";const y=1e3,F="abort",H="end",k="progress",x="start",P="visibilitychange",se=$({__name:"Countdown",props:{autoStart:{type:Boolean,default:!0},emitEvents:{type:Boolean,default:!0},interval:{type:Number,default:1e3,validator:o=>o>=0},now:{type:Function,default:()=>Date.now()},tag:{type:String,default:"div"},time:{type:Number,default:0,validator:o=>o>=0},date:{type:Date,default:null,validator:o=>o.getTime()>=0},transform:{type:Function,default:o=>o},withYears:{type:Boolean,default:!1}},emits:[F,H,k,x],setup(o,{expose:q,emit:U}){const i=60*y,v=60*i,c=24*v,N=365*c,t=o,d=U,l=h(!1),f=h(0),e=h(0),M=h(0),n=a(()=>{var s;return((s=t.date)==null?void 0:s.getTime())-t.now()||t.time}),S=a(()=>t.withYears?Math.floor(e.value/N):0),m=a(()=>t.withYears?Math.floor(e.value%N/c):Math.floor(e.value/c)),D=a(()=>Math.floor(e.value%c/v)),C=a(()=>Math.floor(e.value%v/i)),L=a(()=>Math.floor(e.value%i/y)),T=a(()=>Math.floor(e.value%y)),b=a(()=>t.withYears?m.value+S.value*365:m.value),g=a(()=>Math.floor(e.value/v)),w=a(()=>Math.floor(e.value/i)),B=a(()=>Math.floor(e.value/y));j(()=>{e.value=n.value,f.value=t.now()+n.value,t.autoStart&&_(),document.addEventListener(P,Y)}),J(()=>{document.removeEventListener(P,Y),u()});const _=()=>{l.value||(l.value=!0,t.autoStart||(e.value=n.value,f.value=t.now()+n.value),t.emitEvents&&d(x),document.visibilityState==="visible"&&I())},I=()=>{if(!l.value)return;const s=Math.min(e.value,t.interval);if(s>0){let p,E;const R=r=>{p||(p=r),E||(E=r);const V=r-p;V>=s||V+(r-E)/2>=s?G():M.value=requestAnimationFrame(R),E=r};M.value=requestAnimationFrame(R)}else O()},u=()=>{cancelAnimationFrame(M.value)},G=()=>{l.value&&(A(),t.emitEvents&&e.value>0&&d(k,{years:S.value,days:m.value,hours:D.value,minutes:C.value,seconds:L.value,milliseconds:T.value,totalDays:b.value,totalHours:g.value,totalMinutes:w.value,totalSeconds:B.value,totalMilliseconds:e.value}),I())},z=()=>{l.value&&(u(),l.value=!1,t.emitEvents&&d(F))},O=()=>{l.value&&(u(),e.value=0,l.value=!1,t.emitEvents&&d(H))},A=()=>{l.value&&(e.value=Math.max(0,f.value-t.now()))},Q=()=>{u(),e.value=n.value,f.value=t.now()+n.value,l.value=!1,_()},Y=()=>{switch(document.visibilityState){case"visible":A(),I();break;case"hidden":u();break}},X=a(()=>t.transform({years:S.value,days:m.value,hours:D.value,minutes:C.value,seconds:L.value,milliseconds:T.value,totalDays:b.value,totalHours:g.value,totalMinutes:w.value,totalSeconds:B.value,totalMilliseconds:e.value}));return q({start:_,pause:u,abort:z,end:O,restart:Q}),(s,p)=>(K(),W(oe(o.tag),null,{default:Z(()=>[ee(s.$slots,"default",te(ae(X.value)))]),_:3}))}});export{se as _};
